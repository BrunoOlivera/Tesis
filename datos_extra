[680.
81.9206944
442.800245 
607.900668 
679.969843
59.4920595
16.1314958
674.778154 
675.514761 
680.
298.020296 ]

states_RBF=[array([2.50622189e-15, 1.49006705e-12, 4.52243665e-10, 7.00679746e-08,
       5.54175123e-06, 2.23745794e-04, 4.61150966e-03, 4.85189905e-02,
       2.60591821e-01, 7.14480195e-01, 1.00000000e+00]), array([1.49006705e-12, 4.52243665e-10, 7.00679746e-08, 5.54175123e-06,
       2.23745794e-04, 4.61150966e-03, 4.85189905e-02, 2.60591821e-01,
       7.14480195e-01, 1.00000000e+00, 7.14480195e-01]), array([4.52243665e-10, 7.00679746e-08, 5.54175123e-06, 2.23745794e-04,
       4.61150966e-03, 4.85189905e-02, 2.60591821e-01, 7.14480195e-01,
       1.00000000e+00, 7.14480195e-01, 2.60591821e-01]), array([7.00679746e-08, 5.54175123e-06, 2.23745794e-04, 4.61150966e-03,
       4.85189905e-02, 2.60591821e-01, 7.14480195e-01, 1.00000000e+00,
       7.14480195e-01, 2.60591821e-01, 4.85189905e-02]), array([5.54175123e-06, 2.23745794e-04, 4.61150966e-03, 4.85189905e-02,
       2.60591821e-01, 7.14480195e-01, 1.00000000e+00, 7.14480195e-01,
       2.60591821e-01, 4.85189905e-02, 4.61150966e-03]), array([2.23745794e-04, 4.61150966e-03, 4.85189905e-02, 2.60591821e-01,
       7.14480195e-01, 1.00000000e+00, 7.14480195e-01, 2.60591821e-01,
       4.85189905e-02, 4.61150966e-03, 2.23745794e-04]), array([4.61150966e-03, 4.85189905e-02, 2.60591821e-01, 7.14480195e-01,
       1.00000000e+00, 7.14480195e-01, 2.60591821e-01, 4.85189905e-02,
       4.61150966e-03, 2.23745794e-04, 5.54175123e-06]), array([4.85189905e-02, 2.60591821e-01, 7.14480195e-01, 1.00000000e+00,
       7.14480195e-01, 2.60591821e-01, 4.85189905e-02, 4.61150966e-03,
       2.23745794e-04, 5.54175123e-06, 7.00679746e-08]), array([2.60591821e-01, 7.14480195e-01, 1.00000000e+00, 7.14480195e-01,
       2.60591821e-01, 4.85189905e-02, 4.61150966e-03, 2.23745794e-04,
       5.54175123e-06, 7.00679746e-08, 4.52243665e-10]), array([7.14480195e-01, 1.00000000e+00, 7.14480195e-01, 2.60591821e-01,
       4.85189905e-02, 4.61150966e-03, 2.23745794e-04, 5.54175123e-06,
       7.00679746e-08, 4.52243665e-10, 1.49006705e-12]), array([1.00000000e+00, 7.14480195e-01, 2.60591821e-01, 4.85189905e-02,
       4.61150966e-03, 2.23745794e-04, 5.54175123e-06, 7.00679746e-08,
       4.52243665e-10, 1.49006705e-12, 2.50622189e-15])]




886.5646982100584
1075.8263694616871
1293.1766197231884
1483.9909427319055
1319.5216194813202
949.0902374908775
959.9072615764292
1412.0052992183992
1731.502965470424
1552.6257576759936
992.7315177901646




1165.84842754064
1165.9249200313845
664.7418551340255
229.65549381079632
159.17069012720796
452.95508530764795
1012.1843332396037
1504.4168762505378
1614.8255994014266
1423.8907890828527
1076.6573520657598




1056.3125137463464
1275.601329622166
1159.2079707474304
846.4091099864349
748.5005188964283
1012.8829898304342
1184.7730066073648
998.185288999696
779.2083921646694
679.1680169190147
476.88817497687

2.23745794e-04
4.61150966e-03
4.85189905e-02
2.60591821e-01
7.14480195e-01
1.00000000e+00
7.14480195e-01
2.60591821e-01
4.85189905e-02
4.61150966e-03
2.23745794e-04




1.2652088728634763
1.5258006938634763
1.5304122035234764
1.530417745274706
1.5304177457269497
1.5304177457269523
1.5304177457269497
1.530417745274706
1.530412203523476
1.525800693863476
1.265208872863476


np.array([[3.94528221e-59, 4.92973120e-48, 4.18302025e-38, 2.41033971e-29, 9.43165935e-22,
        2.50622189e-15, 4.52243665e-10, 5.54175123e-06, 4.61150966e-03, 2.60591821e-01, 1.00000000e+00],
       [4.92973120e-48, 4.18302025e-38, 2.41033971e-29, 9.43165935e-22, 2.50622189e-15, 4.52243665e-10, 
       5.54175123e-06, 4.61150966e-03, 2.60591821e-01, 1.00000000e+00, 2.60591821e-01],
       [4.18302025e-38, 2.41033971e-29, 9.43165935e-22, 2.50622189e-15,
       4.52243665e-10, 5.54175123e-06, 4.61150966e-03, 2.60591821e-01,
       1.00000000e+00, 2.60591821e-01, 4.61150966e-03],
       [2.41033971e-29, 9.43165935e-22, 2.50622189e-15, 4.52243665e-10,
       5.54175123e-06, 4.61150966e-03, 2.60591821e-01, 1.00000000e+00,
       2.60591821e-01, 4.61150966e-03, 5.54175123e-06],
       [9.43165935e-22, 2.50622189e-15, 4.52243665e-10, 5.54175123e-06,
       4.61150966e-03, 2.60591821e-01, 1.00000000e+00, 2.60591821e-01,
       4.61150966e-03, 5.54175123e-06, 4.52243665e-10],
       [2.50622189e-15, 4.52243665e-10, 5.54175123e-06, 4.61150966e-03,
       2.60591821e-01, 1.00000000e+00, 2.60591821e-01, 4.61150966e-03,
       5.54175123e-06, 4.52243665e-10, 2.50622189e-15],
       [4.52243665e-10, 5.54175123e-06, 4.61150966e-03, 2.60591821e-01,
       1.00000000e+00, 2.60591821e-01, 4.61150966e-03, 5.54175123e-06,
       4.52243665e-10, 2.50622189e-15, 9.43165935e-22],
       [5.54175123e-06, 4.61150966e-03, 2.60591821e-01, 1.00000000e+00,
       2.60591821e-01, 4.61150966e-03, 5.54175123e-06, 4.52243665e-10,
       2.50622189e-15, 9.43165935e-22, 2.41033971e-29],
       [4.61150966e-03, 2.60591821e-01, 1.00000000e+00, 2.60591821e-01,
       4.61150966e-03, 5.54175123e-06, 4.52243665e-10, 2.50622189e-15,
       9.43165935e-22, 2.41033971e-29, 4.18302025e-38],
       [2.60591821e-01, 1.00000000e+00, 2.60591821e-01, 4.61150966e-03,
       5.54175123e-06, 4.52243665e-10, 2.50622189e-15, 9.43165935e-22,
       2.41033971e-29, 4.18302025e-38, 4.92973120e-48],
       [1.00000000e+00, 2.60591821e-01, 4.61150966e-03, 5.54175123e-06,
       4.52243665e-10, 2.50622189e-15, 9.43165935e-22, 2.41033971e-29,
       4.18302025e-38, 4.92973120e-48, 3.94528221e-59]])



426.02486101288247
923.9594198403868
1014.3855662207045
870.1836790205265
698.9014138400116
911.8745462753105
850.4871993122408
887.7458854808917
819.8211553838644
916.5521923745723
600.7687354456498


np.sum(test33_best_model[:,50] * rbf[-1,:])
np.sum(test33_best_model[:,50] * rbf[-2,:])
np.sum(test33_best_model[:,50] * rbf[-3,:])
np.sum(test33_best_model[:,50] * rbf[-4,:])
np.sum(test33_best_model[:,50] * rbf[-5,:])
np.sum(test33_best_model[:,50] * rbf[-6,:])
np.sum(test33_best_model[:,50] * rbf[-7,:])
np.sum(test33_best_model[:,50] * rbf[-8,:])
np.sum(test33_best_model[:,50] * rbf[-9,:])
np.sum(test33_best_model[:,50] * rbf[-10,:])
np.sum(test33_best_model[:,50] * rbf[-11,:])

859.7579524213362
1004.5348776319003
910.8860113695325
829.4101632426674
298.39467285416924
540.9341010293969
525.9409648075004
483.54450837837067
676.8693316431085
908.8331227370229
819.7996952523245

857.2062069561256
860.3417609445788
360.45226533359806
849.6045876254863
927.3579337399171
740.8534012953669
762.8146672950603
979.7748821702864
862.4730089792943
357.54326775468485
683.1395957029512

-5.86881658e+09
-4.86544872e+09
-4.85085594e+09
-4.85087613e+09
-4.85120396e+09
-4.85120280e+09
-4.85127670e+09
-4.85132070e+09
-4.85161752e+09
-4.86579786e+09
-5.86808875e+09

-5.81184395e+09
-4.81731964e+09
-4.80354412e+09
-4.80354149e+09
-4.80386157e+09
-4.80382460e+09
-4.80329552e+09
-4.80322059e+09
-4.80476152e+09
-4.81880510e+09
-5.80944565e+09

-3.04443249e+09
-2.51522714e+09
-2.49779629e+09
-2.49246827e+09
-2.48963289e+09
-2.48346895e+09
-2.47897188e+09
-2.47421357e+09
-2.46924404e+09
-2.42291371e+09
-2.95299503e+09

-54384762.
-39652573.4
-32709814.
-27406163.3
-23471384.8
-22583069.8
-21825593.5
-19785996.
-20377795.7
-3489155.57
-33091538.9


np.sum(test33_best_value[:,-1] * rbf[-1,:])
np.sum(test33_best_value[:,-1] * rbf[-2,:])
np.sum(test33_best_value[:,-1] * rbf[-3,:])
np.sum(test33_best_value[:,-1] * rbf[-4,:])
np.sum(test33_best_value[:,-1] * rbf[-5,:])
np.sum(test33_best_value[:,-1] * rbf[-6,:])
np.sum(test33_best_value[:,-1] * rbf[-7,:])
np.sum(test33_best_value[:,-1] * rbf[-8,:])
np.sum(test33_best_value[:,-1] * rbf[-9,:])
np.sum(test33_best_value[:,-1] * rbf[-10,:])
np.sum(test33_best_value[:,-1] * rbf[-11,:])


-7159109375.496196
-7681304451.002868
-7432313090.717715
-7424021429.423524
-7424281707.013539
-7424385450.906603
-7424473474.382193
-7424685022.017342
-7433278484.098065
-7681664436.518783
-7158476043.021835

-7089376259.642769
-7605781149.7445965
-7359642893.78117
-7351579662.080327
-7351817947.65064
-7351726088.0469055
-7351176508.1409445
-7351435338.622348
-7361150098.46383
-7606957393.892819
-7087370670.642448

-3711412536.126297
-3970994469.7324266
-3828294915.7523975
-3815233667.8830905
-3809299498.565737
-3801178144.4620094
-3793798546.98134
-3786334161.1434164
-3770458687.3352776
-3847328461.896209
-3595787181.155324

-64868891.82163398
-62475221.42865308
-50543931.84329649
-42333946.8188476
-36749990.06999674
-34605013.17731984
-33069007.674279347
-30904399.83319752
-26696485.878609102
-17514191.11498176
-34094866.36439686


states_RBF_250=np.array([[2.42277060e-234, 5.90599342e-190, 3.06168050e-150, 3.37530501e-115,
       7.91320517e-085, 3.94528221e-059, 4.18302025e-038, 9.43165935e-022,
       4.52243665e-010, 4.61150966e-003, 1.00000000e+000], [5.90599342e-190, 3.06168050e-150, 3.37530501e-115, 7.91320517e-085,
       3.94528221e-059, 4.18302025e-038, 9.43165935e-022, 4.52243665e-010,
       4.61150966e-003, 1.00000000e+000, 4.61150966e-003], [3.06168050e-150, 3.37530501e-115, 7.91320517e-085, 3.94528221e-059,
       4.18302025e-038, 9.43165935e-022, 4.52243665e-010, 4.61150966e-003,
       1.00000000e+000, 4.61150966e-003, 4.52243665e-010], [3.37530501e-115, 7.91320517e-085, 3.94528221e-059, 4.18302025e-038,
       9.43165935e-022, 4.52243665e-010, 4.61150966e-003, 1.00000000e+000,
       4.61150966e-003, 4.52243665e-010, 9.43165935e-022], [7.91320517e-85, 3.94528221e-59, 4.18302025e-38, 9.43165935e-22,
       4.52243665e-10, 4.61150966e-03, 1.00000000e+00, 4.61150966e-03,
       4.52243665e-10, 9.43165935e-22, 4.18302025e-38], [3.94528221e-59, 4.18302025e-38, 9.43165935e-22, 4.52243665e-10,
       4.61150966e-03, 1.00000000e+00, 4.61150966e-03, 4.52243665e-10,
       9.43165935e-22, 4.18302025e-38, 3.94528221e-59], [4.18302025e-38, 9.43165935e-22, 4.52243665e-10, 4.61150966e-03,
       1.00000000e+00, 4.61150966e-03, 4.52243665e-10, 9.43165935e-22,
       4.18302025e-38, 3.94528221e-59, 7.91320517e-85], [9.43165935e-022, 4.52243665e-010, 4.61150966e-003, 1.00000000e+000,
       4.61150966e-003, 4.52243665e-010, 9.43165935e-022, 4.18302025e-038,
       3.94528221e-059, 7.91320517e-085, 3.37530501e-115], [4.52243665e-010, 4.61150966e-003, 1.00000000e+000, 4.61150966e-003,
       4.52243665e-010, 9.43165935e-022, 4.18302025e-038, 3.94528221e-059,
       7.91320517e-085, 3.37530501e-115, 3.06168050e-150], [4.61150966e-003, 1.00000000e+000, 4.61150966e-003, 4.52243665e-010,
       9.43165935e-022, 4.18302025e-038, 3.94528221e-059, 7.91320517e-085,
       3.37530501e-115, 3.06168050e-150, 5.90599342e-190], [1.00000000e+000, 4.61150966e-003, 4.52243665e-010, 9.43165935e-022,
       4.18302025e-038, 3.94528221e-059, 7.91320517e-085, 3.37530501e-115,
       3.06168050e-150, 5.90599342e-190, 2.42277060e-234]])

states_RBF_250[-1,:].sum()
states_RBF_250[-2,:].sum()
states_RBF_250[-3,:].sum()
states_RBF_250[-4,:].sum()
states_RBF_250[-5,:].sum()
states_RBF_250[-6,:].sum()
states_RBF_250[-7,:].sum()
states_RBF_250[-8,:].sum()
states_RBF_250[-9,:].sum()
states_RBF_250[-10,:].sum()
states_RBF_250[-11,:].sum()


1.0046115101122435
1.0092230197722436
1.0092230202244872
1.0092230202244872
1.0092230202244872
1.0092230202244872
1.0092230202244872
1.009223020224487
1.0092230202244872
1.0092230197722436
1.0046115101122437


-5.86907044e+09
-4.86669067e+09
-4.85202613e+09
-4.85200856e+09
-4.85200856e+09
-4.85200856e+09
-4.85200856e+09
-4.85200856e+09
-4.85202613e+09
-4.86669067e+09
-5.86907044e+09




states_RBF_500=([[3.94528221e-59, 4.92973120e-48, 4.18302025e-38, 2.41033971e-29,
       9.43165935e-22, 2.50622189e-15, 4.52243665e-10, 5.54175123e-06,
       4.61150966e-03, 2.60591821e-01, 1.00000000e+00], [4.92973120e-48, 4.18302025e-38, 2.41033971e-29, 9.43165935e-22,
       2.50622189e-15, 4.52243665e-10, 5.54175123e-06, 4.61150966e-03,
       2.60591821e-01, 1.00000000e+00, 2.60591821e-01], [4.18302025e-38, 2.41033971e-29, 9.43165935e-22, 2.50622189e-15,
       4.52243665e-10, 5.54175123e-06, 4.61150966e-03, 2.60591821e-01,
       1.00000000e+00, 2.60591821e-01, 4.61150966e-03], [2.41033971e-29, 9.43165935e-22, 2.50622189e-15, 4.52243665e-10,
       5.54175123e-06, 4.61150966e-03, 2.60591821e-01, 1.00000000e+00,
       2.60591821e-01, 4.61150966e-03, 5.54175123e-06], [9.43165935e-22, 2.50622189e-15, 4.52243665e-10, 5.54175123e-06,
       4.61150966e-03, 2.60591821e-01, 1.00000000e+00, 2.60591821e-01,
       4.61150966e-03, 5.54175123e-06, 4.52243665e-10], [2.50622189e-15, 4.52243665e-10, 5.54175123e-06, 4.61150966e-03,
       2.60591821e-01, 1.00000000e+00, 2.60591821e-01, 4.61150966e-03,
       5.54175123e-06, 4.52243665e-10, 2.50622189e-15], [4.52243665e-10, 5.54175123e-06, 4.61150966e-03, 2.60591821e-01,
       1.00000000e+00, 2.60591821e-01, 4.61150966e-03, 5.54175123e-06,
       4.52243665e-10, 2.50622189e-15, 9.43165935e-22], [5.54175123e-06, 4.61150966e-03, 2.60591821e-01, 1.00000000e+00,
       2.60591821e-01, 4.61150966e-03, 5.54175123e-06, 4.52243665e-10,
       2.50622189e-15, 9.43165935e-22, 2.41033971e-29], [4.61150966e-03, 2.60591821e-01, 1.00000000e+00, 2.60591821e-01,
       4.61150966e-03, 5.54175123e-06, 4.52243665e-10, 2.50622189e-15,
       9.43165935e-22, 2.41033971e-29, 4.18302025e-38], [2.60591821e-01, 1.00000000e+00, 2.60591821e-01, 4.61150966e-03,
       5.54175123e-06, 4.52243665e-10, 2.50622189e-15, 9.43165935e-22,
       2.41033971e-29, 4.18302025e-38, 4.92973120e-48], [1.00000000e+00, 2.60591821e-01, 4.61150966e-03, 5.54175123e-06,
       4.52243665e-10, 2.50622189e-15, 9.43165935e-22, 2.41033971e-29,
       4.18302025e-38, 4.92973120e-48, 3.94528221e-59]])



[59929497.55486494],
       [43174478.5260043 ],
       [47561261.25088449],
       [46416462.68256557],
       [46719709.11446906],
       [46621824.73404592],
       [46719709.11446907],
       [46416462.68256556],
       [47561261.25088449],
       [43174478.5260043 ],
       [59929497.55486492]



[59929497.55486493],
       [43174478.5260043 ],
       [47561261.25088448],
       [46416462.68256558],
       [46719709.11446906],
       [46621824.73404592],
       [46719709.11446907],
       [46416462.68256556],
       [47561261.2508845 ],
       [43174478.52600431],
       [59929497.55486493]



-6.23266775e+09
-4.49014577e+09
-4.94637117e+09
-4.82731212e+09
-4.85884975e+09
-4.84866977e+09
-4.85884975e+09
-4.82731212e+09
-4.94637117e+09
-4.49014577e+09
-6.23266775e+09



states_RBF_250=([[2.42277060e-234, 5.90599342e-190, 3.06168050e-150, 3.37530501e-115,
       7.91320517e-085, 3.94528221e-059, 4.18302025e-038, 9.43165935e-022,
       4.52243665e-010, 4.61150966e-003, 1.00000000e+000], [5.90599342e-190, 3.06168050e-150, 3.37530501e-115, 7.91320517e-085,
       3.94528221e-059, 4.18302025e-038, 9.43165935e-022, 4.52243665e-010,
       4.61150966e-003, 1.00000000e+000, 4.61150966e-003], [3.06168050e-150, 3.37530501e-115, 7.91320517e-085, 3.94528221e-059,
       4.18302025e-038, 9.43165935e-022, 4.52243665e-010, 4.61150966e-003,
       1.00000000e+000, 4.61150966e-003, 4.52243665e-010], [3.37530501e-115, 7.91320517e-085, 3.94528221e-059, 4.18302025e-038,
       9.43165935e-022, 4.52243665e-010, 4.61150966e-003, 1.00000000e+000,
       4.61150966e-003, 4.52243665e-010, 9.43165935e-022], [7.91320517e-85, 3.94528221e-59, 4.18302025e-38, 9.43165935e-22,
       4.52243665e-10, 4.61150966e-03, 1.00000000e+00, 4.61150966e-03,
       4.52243665e-10, 9.43165935e-22, 4.18302025e-38], [3.94528221e-59, 4.18302025e-38, 9.43165935e-22, 4.52243665e-10,
       4.61150966e-03, 1.00000000e+00, 4.61150966e-03, 4.52243665e-10,
       9.43165935e-22, 4.18302025e-38, 3.94528221e-59], [4.18302025e-38, 9.43165935e-22, 4.52243665e-10, 4.61150966e-03,
       1.00000000e+00, 4.61150966e-03, 4.52243665e-10, 9.43165935e-22,
       4.18302025e-38, 3.94528221e-59, 7.91320517e-85], [9.43165935e-022, 4.52243665e-010, 4.61150966e-003, 1.00000000e+000,
       4.61150966e-003, 4.52243665e-010, 9.43165935e-022, 4.18302025e-038,
       3.94528221e-059, 7.91320517e-085, 3.37530501e-115], [4.52243665e-010, 4.61150966e-003, 1.00000000e+000, 4.61150966e-003,
       4.52243665e-010, 9.43165935e-022, 4.18302025e-038, 3.94528221e-059,
       7.91320517e-085, 3.37530501e-115, 3.06168050e-150], [4.61150966e-003, 1.00000000e+000, 4.61150966e-003, 4.52243665e-010,
       9.43165935e-022, 4.18302025e-038, 3.94528221e-059, 7.91320517e-085,
       3.37530501e-115, 3.06168050e-150, 5.90599342e-190], [1.00000000e+000, 4.61150966e-003, 4.52243665e-010, 9.43165935e-022,
       4.18302025e-038, 3.94528221e-059, 7.91320517e-085, 3.37530501e-115,
       3.06168050e-150, 5.90599342e-190, 2.42277060e-234]])













405.333181
678.259719
678.534483
677.652401
678.659012
675.502642
675.972877
674.434408
678.335083
679.460592
680.0

def bla(t):
       for v in ticks:
           volume_state = [v, t]
           ind[-1] = volume_state[-1]
           temp_state[tuple(ind)] = np.array([np.exp(-np.linalg.norm(volume_state[:-1][0] - ci)**2 / (2 * sigma**2)) for ci in centers]).reshape(tuple(num_centers[:-1]))
           print(np.sum(best_model[:,t] * temp_state[:,t]))




153.68 --> 92.945664


500

500


min(680, (8200 + x.aporte) / (0.0036 * self._linea_tiempo.horas_paso))





# >>> res_250
676.89289669
673.77133217
673.7857273
673.78566091
673.78566122
673.78566122
673.78566122
673.78566091
673.7857273
673.77133217
676.89289669



# >>> res_500
570.75711957
411.18550977
452.96439287
442.06154936
444.94961061
444.01737842
444.94961061
442.06154936
452.96439287
411.18550977
570.75711957
